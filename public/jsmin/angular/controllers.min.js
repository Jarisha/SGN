var AboutController=["$scope","$rootScope","$http","$location","resolveAbout","$routeParams",function(a,b,c,d,e,f){switch(b.css="about",b.title="about",a.modals=b.rootPath+"/partials/modals",a.subnav=null,a.nav=b.rootPath+"/partials/navbar",a.content=b.rootPath+"/partials/about/about_content",a.section=b.rootPath+"/partials/about/faq",a.setup=function(){aboutSetup(a)},a.viewFAQ=function(){$(".about_selected").removeClass("about_selected"),$(".faq_slice").addClass("about_selected"),a.section=b.rootPath+"/partials/about/faq"},a.viewToS=function(){$(".about_selected").removeClass("about_selected"),$(".tos_slice").addClass("about_selected"),a.section=b.rootPath+"/partials/about/tos"},a.viewPrivacy=function(){$(".about_selected").removeClass("about_selected"),$(".privacy_slice").addClass("about_selected"),a.section=b.rootPath+"/partials/about/privacy"},a.viewAcceptable=function(){$(".about_selected").removeClass("about_selected"),$(".view_slice").addClass("about_selected"),a.section=b.rootPath+"/partials/about/acceptable"},f.area){case"faq":$(".about_selected").removeClass("about_selected"),$(".faq_slice").addClass("about_selected"),a.section=b.rootPath+"/partials/about/faq",a.viewFAQ();break;case"tos":$(".about_selected").removeClass("about_selected"),$(".tos_slice").addClass("about_selected"),a.section=b.rootPath+"/partials/about/tos",a.viewToS();break;case"privacy":$(".about_selected").removeClass("about_selected"),$(".privacy_slice").addClass("about_selected"),a.section=b.rootPath+"/partials/about/privacy",a.viewPrivacy();break;case"acceptable":$(".about_selected").removeClass("about_selected"),$(".view_slice").addClass("about_selected"),a.section=b.rootPath+"/partials/about/acceptable",a.viewAcceptable()}a.ajaxLogout=function(){b.logout(function(b){b.message&&(a.status=b.message)})}}];AboutController.resolve={resolveAbout:["$q","$rootScope","$location",function(a,b,c){var d=a.defer();return $("#gamePinModal").modal("hide"),b.checkLogin(function(a,b){a?d.reject(a):b?d.resolve():c.path("/")}),d.promise}]};var FrontController=["$scope","$rootScope","$http","$location","$templateCache","$timeout","$routeParams","resolveFront","gamepinService","$window",function(a,b,c,d,e,f,g,h,j,k){function l(){for(o=m+n;o>m&&a.gamePins[m];m++)a.showPins.push(a.gamePins[m])}a.showPins=[],a.gamePins=h,a.recommendedPins=[],b.css="front",a.modals=b.rootPath+"/partials/modals",a.subnav=b.rootPath+"/partials/front/front_subnav",a.nav=b.rootPath+"/partials/navbar",a.content=b.rootPath+"/partials/front_content",a.searchText="",a.appendHtml="",a.container=$("#content"),a.masonInit=!0,a.flag=!0,a.bigPin={},a.bigPin.followBtn=!0;var m=0,n=20,o=0;l(),a.fbModal=function(){$("#fbRegisterModal").modal()},a.changeState=function(){a.masonInit=!1},k.onscroll=function(){var b=document.documentElement.scrollHeight-document.documentElement.clientHeight,c=k.pageYOffset;a.flag&&300>=b-c&&(100>=b-c&&$(".rackspace_logo").fadeIn(),a.$apply(a.loadMore()),a.flag=!1),b-c>=400&&$(".rackspace_logo").fadeOut()},a.setup=function(){frontSetup(a,b,c)},a.getfront=function(){b.destroyMason(),a.showPins=[],j.getPinList(function(b){a.gamePins=b.objects,m=0,n=20,o=0,l()})},a.catSearch=function(b){function c(){d=a.gamePins,m=0,n=20,o=0,a.showPins=[],a.gamePins=d,l()}var d=[];j.categorySearch(b,function(b){a.gamePins=b.objects,c()})},a.textsearch=function(b){function c(){d=a.gamePins,m=0,n=20,o=0,a.showPins=[],a.gamePins=d,l()}var d=[];j.textSearch(b,function(b){a.gamePins=b.objects,c()})},a.getFollowing=function(){function d(){var c=a.gamePins.slice();for(i=0;i<c.length;i++)f[c[i].poster]||(c.splice(i,1),i--);a.gamePins=c,m=0,n=20,o=0,l(),b.masonry()}var e,f={};a.showPins=[],b.destroyMason(),c({method:"post",url:"/api/user/getProfile",data:{email:b.userEmail}}).success(function(a){for(e=a.profileData.following,i=0,len=e.length;len>i;i++)f[e[i].userName]=!0;d()}).error(function(a){alert(a)})},a.getPopular=function(){function c(a,b){return a.comments.length+a.likedBy.length<b.comments.length+b.likedBy.length?1:-1}a.showPins=[],b.destroyMason();var d=a.gamePins.slice();d.sort(c),a.gamePins=d,m=0,n=20,o=0,l(),b.masonry()},b.popRecommended=function(b){$("#gamePinModal").modal("hide"),a.viewBigPin(b)},a.viewBigPin=function(d){console.log(a.showPins[d].poster),$(".view_vid").empty(),j.getPinData(a.showPins[d].id,function(e){if(a.bigPin.index=d,a.bigPin=a.showPins[d],a.bigPin.posterImg=a.bigPin.posterImg||b.rootPath+"/images/30x30.gif",a.bigPin.gameName=e.gameName,a.bigPin.publisher=e.publisher,a.bigPin.datePosted=e.datePosted,a.bigPin.videoEmbed=e.videoEmbed,a.bigPin.comments=e.comments,console.log(a.bigPin.posterName+" === "+b.userName),a.bigPin.videoEmbed){var f=$.parseHTML(a.bigPin.videoEmbed);f[0].width="560",f[0].height="341",$(".view_vid").append(f)}for(a.recommendedPins=[],i=0,len=a.showPins.length;len>i;i++)a.showPins[i].category===a.bigPin.category&&a.showPins[i].id!==a.bigPin.id&&a.recommendedPins.push({index:i,image:a.showPins[i].imageUrl||a.showPins[i].sourceUrl,link:"/post/"+a.showPins[i].id});$("#recommend_sidebar").css("display","block"),$("#gamePinModal").modal({dynamic:!0}),c({method:"post",url:"/api/getFollowers",data:{email:b.userEmail}}).success(function(c){if(c.error)b.popNotify("Error",c.error);else if(c.success){var e=c.following;$("#gamePinModal .follow"),a.bigFollowBtn=a.showPins[d].poster===b.userName||-1!==e.indexOf(a.bigPin.posterId)?!1:!0}}).error(function(){})})},a.follow=function(c){var d=b.follow(c);d.then(function(){a.bigPin.followBtn=!1},function(){console.log("$rootScope follow failed"),a.bigPin.followBtn=!1})},a.setupModals=function(){b.setupPostContent(),c({method:"POST",url:"/api/facebookRegister"}).success(function(a){a.fb&&(b.register.email=a.fbEmail,b.register.name=a.fbName,b.register.fbConnect=!0,$("#fbRegisterModal").modal())}).error(function(b,c){a.message="Server Error: "+c}),sessionStorage.registerAlert&&(b.popNotify(sessionStorage.registerAlert),sessionStorage.removeItem("registerAlert"))},a.addBigComment=function(d){a.bigPin.comments.push({posterName:b.userName,content:d,posterImg:b.userImg}),c({method:"post",url:"/api/gamepin/addComment",data:{pinId:a.bigPin.id,posterId:b.userEmail,posterName:b.userName,content:d}}).success(function(){$("textarea.view_respond_txtarea").val(""),b.remason()}).error(function(){})},a.addComment=function(d,e){b.rootSettings,a.showPins[e].comments.push({posterName:b.userName,content:d,posterImg:b.userImg}),c({method:"post",url:"/api/gamepin/addComment",data:{pinId:a.showPins[e].id,posterId:b.userEmail,posterName:b.userName,content:d}}).success(function(c){c.error,a.text=null,b.remason()}).error(function(){})},a.loadMore=function(){console.log("loadMore");var c=[];for(o=m+n;o>m;m++)a.gamePins[m]&&c.push(a.gamePins[m]);a.showPins=a.showPins.concat(c),b.reload(),f(function(){a.flag=!0},100)},a.loadOne=function(){a.showPins.push({id:"Z",description:"Z",poster:"Z",category:"Z"}),a.showPins.push({id:"Z",description:"Z",poster:"Z",category:"Z"}),a.showPins.push({id:"Z",description:"Z",poster:"Z",category:"Z"}),a.showPins.push({id:"Z",description:"Z",poster:"Z",category:"Z"}),a.showPins.push({id:"Z",description:"Z",poster:"Z",category:"Z"}),a.showPins.push({id:"Z",description:"Z",poster:"Z",category:"Z"}),f(function(){a.flag=!0},100)},a.affix=function(){$("#subnav").affix({offset:42})}}];FrontController.resolve={resolveFront:["$q","$rootScope","gamepinService",function(a,b,c){var d=a.defer();return $("#gamePinModal").modal("hide"),b.checkLogin(function(a){a&&d.reject(a),c.getPinList(function(a){a.objects?d.resolve(a.objects):d.reject("Error")})}),d.promise}]};var StoreController=["$scope","$rootScope","$http","$location","$templateCache","resolveStore",function(a,b){b.css="store",b.title="front",a.subnav=b.rootPath+"/partials/store_subnav",a.nav=b.rootPath+"/partials/navbar",a.content=b.rootPath+"/partials/store_content",a.register={name:null,password:null,confirm:null},a.login={name:null,password:null},a.masonInit=!0,a.bigPin={},a.changeState=function(){a.masonInit=!1},a.dummyData=[{name:"Minecraft",price:"Free",publisher:"Mojang",image:"http://localhost/images/game_images/store_img2.png",screenshot:"https://minecraft.net/images/mobile/desktop_screen4.png",video:"http://youtu.be/FaMTedT6P0I",description:"We're extremely happy to finally roll out Minecraft â€“ Pocket Edition on most devices running Android or iOS in the Solar System. Now no matter where you are there's always time to place blocks and build whatever your heart can imagine.",category:"Strategy",playStoreUrl:"https://play.google.com/store/apps/details?id=com.mojang.minecraftpe",platform:"Android"},{name:"Great Big War Game",price:"$4.99",image:"http://localhost/images/game_images/store_img3.png",category:"Strategy",playStoreUrl:"https://play.google.com/store/apps/details?id=com.rubicon.dev.gbwg",platform:"Android"},{name:"Angry Birds Space Premium",price:"N/A",image:"http://localhost/images/game_images/store_img4.png",category:"Puzzle",playStoreUrl:"https://play.google.com/store/apps/details?id=com.rovio.angrybirdsspace.premium",platform:"Android"},{name:"Cut the Rope",price:"$0.99",image:"http://localhost/images/game_images/store_img5.png",category:"Puzzle",playStoreUrl:"https://play.google.com/store/apps/details?id=com.zeptolab.ctr.paid",platform:"Android"},{name:"Move the Box Pro",price:"$0.99",image:"https://lh3.ggpht.com/hhurG5c5QP9dn6AN80mPdkxrK_0BwsRrNaEnXSANenpoFH0nKXkDJLTLIvAG_5vgdA=w124",category:"Puzzle",playStoreUrl:"https://play.google.com/store/apps/details?id=ua.co.cts.movethebox",platform:"Android"},{name:"Bomba",price:"$0.99",image:"https://lh3.ggpht.com/dKcPug5YXNwEULvix5WMPGjvEEbAFINvbm8Xbko0NRk4S9bdeTGGBxXWKcyUiIiJ9-Y=w124",category:"Puzzle",playStoreUrl:"https://play.google.com/store/apps/details?id=com.GamesLab.Bomba",platform:"Android"},{name:"SpellTower",price:"$1.99",image:"http://a1.mzstatic.com/us/r1000/092/Purple/v4/49/52/7d/49527d33-52c8-1b0e-7d19-6667853cc697/mza_5638865484617812239.175x175-75.jpg",category:"Puzzle",appStoreUrl:"https://itunes.apple.com/us/app/spelltower/id476500832?mt=8",platform:"iPhone"}],a.viewStorePin=function(b){a.bigPin=a.dummyData[b],$("#storePinModal").modal({dynamic:!0})},a.setup=function(){storeSetup(a)}}];StoreController.resolve={resolveStore:["$q","$rootScope","$location",function(a,b,c){var d=a.defer();return $("#gamePinModal").modal("hide"),b.checkLogin(function(a,b){a?d.reject(a):b?d.resolve():c.path("/")}),d.promise}]};var ProfileController=["$scope","$rootScope","$http","$location","$timeout","resolveProfile","gamepinService",function(a,b,c,d,e,f,g){console.log("ProfileController"),b.css="profile",b.title="profile",a.R_Data=f,a.timeline=f.timeline,a.profile=f.profileData,a.profile.bio=a.profile.bio||null,a.dummyData={badges:[{url:"http://localhost/images/misc_images/badge1.png"},{url:"http://localhost/images/misc_images/badge1.png"},{url:"http://localhost/images/misc_images/badge1.png"},{url:"http://localhost/images/misc_images/badge1.png"},{url:"http://localhost/images/misc_images/badge1.png"},{url:"http://localhost/images/misc_images/badge1.png"},{url:"http://localhost/images/misc_images/badge1.png"},{url:"http://localhost/images/misc_images/badge1.png"},{url:"http://localhost/images/misc_images/badge1.png"},{url:"http://localhost/images/misc_images/badge1.png"}],followers:[{url:"http://localhost/images/30x30.gif"},{url:"http://localhost/images/30x30.gif"}],following:[{url:"http://localhost/images/30x30.gif"},{url:"http://localhost/images/30x30.gif"}]},a.showPins=a.activityPins,a.groupList=[],a.groupData={},a.modals=b.rootPath+"/partials/modals",a.subnav=null,a.nav=b.rootPath+"/partials/navbar",a.content=b.rootPath+"/partials/profile_content",a.masonInit=!0,a.FOLLOW=1,a.FRIEND=2,a.GROUPS=1,a.LIKES=3,a.people_tab=a.FOLLOW,a.timeline_tab="showAll",a.group_tab=null,a.bigPin={},a.bigFollowBtn=!1,a.changeImage=!1,a.showGroups=!1,a.changeState=function(){a.masonInit=!1};for(var h in a.timeline){var i=a.timeline[h];if("commentPosted"===i.action)switch(i.message="Comment posted to "+i.target,i.target){case"Action & Adventure":i.sourceImg="/images/caticon-action22x22.png";break;case"Arcade":i.sourceImg="/images/caticon-arcade22x22.png";break;case"Board & Card":i.sourceImg="/images/caticon-card22x22.png";break;case"Casino & Gambling":i.sourceImg="/images/caticon-casino22x22.png";break;case"Educational":i.sourceImg="/images/caticon-educational22x22.png";break;case"Family & Kids":i.sourceImg="/images/caticon-family22x22.png";break;case"Music & Rhythm":i.sourceImg="/images/caticon-music22x22.png";break;case"Puzzle":i.sourceImg="/images/caticon-puzzle22x22.png";break;case"Racing":i.sourceImg="/images/caticon-racing22x22.png";break;case"Role Playing":i.sourceImg="/images/caticon-rpg22x22.png";break;case"Simulation":i.sourceImg="/images/caticon-simulation22x22.png";break;case"Sports":i.sourceImg="/images/caticon-sports22x22.png";break;case"Strategy":i.sourceImg="/images/caticon-strategy22x22.png";break;case"Trivia & Word":i.sourceImg="/images/caticon-arcade22x22.png";break;default:alert("event image: default case")}for(var h in a.timeline){var i=a.timeline[h];if("commentPosted"===i.action)switch(i.message="Comment posted to "+i.target,i.target){case"Action & Adventure":i.sourceImg="/images/caticon-action22x22.png";break;case"Arcade":i.sourceImg="/images/caticon-arcade22x22.png";break;case"Board & Card":i.sourceImg="/images/caticon-card22x22.png";break;case"Casino & Gambling":i.sourceImg="/images/caticon-casino22x22.png";break;case"Educational":i.sourceImg="/images/caticon-educational22x22.png";break;case"Family & Kids":i.sourceImg="/images/caticon-family22x22.png";break;case"Music & Rhythm":i.sourceImg="/images/caticon-music22x22.png";break;case"Puzzle":i.sourceImg="/images/caticon-puzzle22x22.png";break;case"Racing":i.sourceImg="/images/caticon-racing22x22.png";break;case"Role Playing":i.sourceImg="/images/caticon-rpg22x22.png";break;case"Simulation":i.sourceImg="/images/caticon-simulation22x22.png";break;case"Sports":i.sourceImg="/images/caticon-sports22x22.png";break;case"Strategy":i.sourceImg="/images/caticon-strategy22x22.png";break;case"Trivia & Word":i.sourceImg="/images/caticon-arcade22x22.png";break;default:alert("event image: default case")}else if("gamepinPosted"===i.action)switch(i.message="Posted to "+i.target,i.target){case"Action & Adventure":i.sourceImg="/images/caticon-action22x22.png";break;case"Arcade":i.sourceImg="/images/caticon-arcade22x22.png";break;case"Board & Card":i.sourceImg="/images/caticon-card22x22.png";break;case"Casino & Gambling":i.sourceImg="/images/caticon-casino22x22.png";break;case"Educational":i.sourceImg="/images/caticon-educational22x22.png";break;case"Family & Kids":i.sourceImg="/images/caticon-family22x22.png";break;case"Music & Rhythm":i.sourceImg="/images/caticon-music22x22.png";break;case"Puzzle":i.sourceImg="/images/caticon-puzzle22x22.png";break;case"Racing":i.sourceImg="/images/caticon-racing22x22.png";break;case"Role Playing":i.sourceImg="/images/caticon-rpg22x22.png";break;case"Simulation":i.sourceImg="/images/caticon-simulation22x22.png";break;case"Sports":i.sourceImg="/images/caticon-sports22x22.png";break;case"Strategy":i.sourceImg="/images/caticon-strategy22x22.png";break;case"Trivia & Word":i.sourceImg="/images/caticon-arcade22x22.png";break;default:alert("event image: default case")}else"followSent"===i.action?(i.message="Following "+i.targetData.userName,i.sourceImg=i.targetData.profileImg||"/images/30x30.gif"):"friendAccepted"===i.action&&(i.targetData.userName!==a.profile.userName?(i.message="Friended "+i.targetData.userName,i.sourceImg=i.targetData.profileImg||"/images/30x30.gif",i.targetLink="/user/"+i.targetData.userName):(i.message="Friended "+i.sourceData.userName,i.sourceImg=i.sourceData.profileImg||"/images/30x30.gif",i.targetLink="/user/"+i.sourceData.userName))}a.setup=function(){$(window).scroll(function(){$(this).scrollTop()>200?$("#scrollup").fadeIn():$("#scrollup").fadeOut()}),$(".change_avatar"),a.scrollup=function(){$("html, body").animate({scrollTop:0},600)}},a.ajaxLogout=function(){b.logout(function(b){b.message&&(a.status=b.message)})},a.viewBigPin=function(d){$(".view_vid").empty(),g.getPinData(d.id,function(e){if(a.bigPin=d,a.bigPin.gameName=e.gameName,a.bigPin.publisher=e.publisher,a.bigPin.datePosted=e.datePosted,a.bigPin.videoEmbed=e.videoEmbed,a.bigPin.comments=e.comments,a.bigPin.profileImg=e.profileImg||b.rootPath+"/images/30x30.gif",a.bigPin.videoEmbed){var f=$.parseHTML(a.bigPin.videoEmbed);f[0].width="560",f[0].height="341",$(".view_vid").append(f)}$("#gamePinModal").modal({dynamic:!0}),c({method:"post",url:"/api/getFollowers",data:{email:b.userEmail}}).success(function(c){if(c.error)b.popNotify("Error",c.error);else if(c.success){var d=c.following;$("#gamePinModal .follow"),a.bigFollowBtn=-1!==d.indexOf(a.bigPin.posterId)?!1:!0}}).error(function(a){console.log(a)})})},a.addBigComment=function(d){a.bigPin.comments.push({posterName:b.userName,content:d,posterImg:b.userImg}),c({method:"post",url:"/api/gamepin/addComment",data:{pinId:a.bigPin.id,posterId:b.userEmail,posterName:b.userName,content:d}}).success(function(){$("textarea.view_respond_txtarea").val("")}).error(function(){})},a.toggleCategories=function(){a.groupToggle?($("#view_groups .dropdown-menu").css("display","none"),a.groupToggle=!1):($("#view_groups .dropdown-menu").css("display","block"),a.groupToggle=!0)},a.getGroupData=function(){a.displayMode.activity=!1,a.displayMode.group=!0,c({method:"post",url:"/api/user/getGroups",data:{userName:a.profile.userName}}).success(function(b){a.groupList=[],a.groupData=b.groups;for(var c in b.groups)a.groupList.push(c);a.showPins=null}).error(function(a){console.log(a)})},a.showGroup=function(b){a.showPins=a.groupData[b]},a.showActivity=function(){a.displayMode.activity=!0,a.displayMode.group=!1,a.showPins=a.activityPins},a.showLikes=function(){c({method:"post",url:"/api/user/getLikedPins",data:{email:a.profile.email,pinIds:a.profile.likes}}).success(function(c){c.error?b.popNotify("Error",c.error):c.likedPins&&(a.showPins=c.likedPins)}).error(function(a){console.log(a)})}}a.addBigComment=function(d){a.bigPin.comments.push({posterName:b.userName,content:d,posterImg:b.userImg}),c({method:"post",url:"/api/gamepin/addComment",data:{pinId:a.bigPin.id,posterId:b.userEmail,posterName:b.userName,content:d}}).success(function(){$("textarea.view_respond_txtarea").val("")}).error(function(){})},a.getGroupData=function(){a.showGroups=!0,c({method:"post",url:"/api/user/getGroups",data:{userName:a.profile.userName}}).success(function(b){a.groupList=[],a.groupData=b.groups;for(var c in b.groups)a.groupList.push(c)})},a.showGroup=function(b){a.group_tab=b,a.showPins=a.groupData[b]},a.showLikes=function(){a.showGroups=!1,c({method:"post",url:"/api/user/getLikedPins",data:{email:a.profile.email,pinIds:a.profile.likes}}).success(function(c){c.error?b.popNotify("Error",c.error):c.likedPins&&(a.showPins=c.likedPins)}).error(function(a){console.log(a)})}}];ProfileController.resolve={resolveProfile:function(a,b,c,d){var e=a.defer();return b.checkLogin(function(a,f){a?e.reject(a):f?d({method:"post",url:"/api/user/getProfile",data:{userName:b.userName}}).success(function(a){a.error&&e.reject(),e.resolve(a)}).error(function(a){e.reject(a)}):c.path("/")}),e.promise}};var TempController=["$scope","$rootScope","$http","$location","$routeParams","$route","gamepinService","resolveTemp",function(a,b,c,d,e,f,g){var h=f.current.params.postId;console.log(b.loggedIn),console.log("TempController"),console.log("id: "+h),b.css="post",b.title="post",a.pagePin={},g.getPinData(h,function(b){a.pagePin=b,console.log(b)})}];TempController.resolve={resolveTemp:["$q","$rootScope","$location",function(a){var b=a.defer();return $("#gamePinModal").modal("hide"),b.resolve(),b.promise}]};var UserController=["$scope","$rootScope","$http","$location","$routeParams","resolveUser","gamepinService",function(a,b,c,d,e,f,g){console.log("UserController"),b.css="profile",b.title="user",a.activityPins=f.activityData,a.timeline=f.timeline,a.user=f.profileData,a.user.bio=a.user.bio||null,a.showPins=a.activityPins,a.groupList=[],a.groupData={},a.bigPin={},a.bigPin.followBtn=!1,a.isFollowing=!1,a.isFriend=!1,a.FOLLOW=1,a.FRIEND=2,a.GROUPS=1,a.LIKES=3,a.showGroups=!1,a.people_tab=a.FOLLOW,a.content_tab=a.ACTIVITY,a.timeline_tab="showAll",a.modals=b.rootPath+"/partials/modals";for(var h in a.timeline){var i=a.timeline[h];if("commentPosted"===i.action)switch(i.message="Comment posted to "+i.target,i.target){case"Action & Adventure":i.sourceImg="/images/caticon-action22x22.png";break;case"Arcade":i.sourceImg="/images/caticon-arcade22x22.png";break;case"Board & Card":i.sourceImg="/images/caticon-card22x22.png";break;case"Casino & Gambling":i.sourceImg="/images/caticon-casino22x22.png";break;case"Educational":i.sourceImg="/images/caticon-educational22x22.png";break;case"Family & Kids":i.sourceImg="/images/caticon-family22x22.png";break;case"Music & Rhythm":i.sourceImg="/images/caticon-music22x22.png";break;case"Puzzle":i.sourceImg="/images/caticon-puzzle22x22.png";break;case"Racing":i.sourceImg="/images/caticon-racing22x22.png";break;case"Role Playing":i.sourceImg="/images/caticon-rpg22x22.png";break;case"Simulation":i.sourceImg="/images/caticon-simulation22x22.png";break;case"Sports":i.sourceImg="/images/caticon-sports22x22.png";break;case"Strategy":i.sourceImg="/images/caticon-strategy22x22.png";break;case"Trivia & Word":i.sourceImg="/images/caticon-arcade22x22.png";break;default:alert("event image: default case")}else if("gamepinPosted"===i.action)switch(i.message="Posted to "+i.target,i.target){case"Action & Adventure":i.sourceImg="/images/caticon-action22x22.png";break;case"Arcade":i.sourceImg="/images/caticon-arcade22x22.png";break;case"Board & Card":i.sourceImg="/images/caticon-card22x22.png";break;case"Casino & Gambling":i.sourceImg="/images/caticon-casino22x22.png";break;case"Educational":i.sourceImg="/images/caticon-educational22x22.png";break;case"Family & Kids":i.sourceImg="/images/caticon-family22x22.png";break;case"Music & Rhythm":i.sourceImg="/images/caticon-music22x22.png";break;case"Puzzle":i.sourceImg="/images/caticon-puzzle22x22.png";break;case"Racing":i.sourceImg="/images/caticon-racing22x22.png";break;case"Role Playing":i.sourceImg="/images/caticon-rpg22x22.png";break;case"Simulation":i.sourceImg="/images/caticon-simulation22x22.png";break;case"Sports":i.sourceImg="/images/caticon-sports22x22.png";break;case"Strategy":i.sourceImg="/images/caticon-strategy22x22.png";break;case"Trivia & Word":i.sourceImg="/images/caticon-arcade22x22.png";break;default:alert("event image: default case")}else"followSent"===i.action?(i.message="Following "+i.targetData.userName,i.sourceImg=i.targetData.profileImg||"/images/30x30.gif"):"friendAccepted"===i.action&&(i.targetData.userName!==a.user.userName?(i.message="Friended "+i.targetData.userName,i.sourceImg=i.targetData.profileImg||"/images/30x30.gif",i.targetLink="/user/"+i.targetData.userName):(i.message="Friended "+i.sourceData.userName,i.sourceImg=i.sourceData.profileImg||"/images/30x30.gif",i.targetLink="/user/"+i.sourceData.userName))}for(var j=0,k=a.user.followers.length;k>j;j++)if(a.user.followers[j].userName===b.userName){a.isFollowing=!0;break}for(var j=0,k=a.user.friends.length;k>j;j++)if(a.user.friends[j].userName===b.userName){a.isFriend=!0;break}a.masonInit=!0,a.changeState=function(){a.masonInit=!1},a.setup=function(){$(window).scroll(function(){$(this).scrollTop()>200?$("#scrollup").fadeIn():$("#scrollup").fadeOut()}),$(".change_avatar"),a.scrollup=function(){$("html, body").animate({scrollTop:0},600)}},a.viewBigPin=function(d){g.getPinData(d.id,function(e){if(a.bigPin=d,a.bigPin.gameName=e.gameName,a.bigPin.publisher=e.publisher,a.bigPin.datePosted=e.datePosted,a.bigPin.videoEmbed=e.videoEmbed,a.bigPin.comments=e.comments,a.bigPin.profileImg=e.profileImg||b.rootPath+"/images/30x30.gif",a.bigPin.videoEmbed){var f=$.parseHTML(a.bigPin.videoEmbed);f[0].width="560",f[0].height="341",$(".view_vid").append(f)}$("#gamePinModal").modal({dynamic:!0}),c({method:"post",url:"/api/getFollowers",data:{email:b.userEmail}}).success(function(c){if(c.error)b.popNotify("Error",c.error);else if(c.success){var d=c.following;a.bigPin.followBtn=-1!==d.indexOf(a.bigPin.posterId)?!1:!0}}).error(function(a){console.log(a)})})},a.addBigComment=function(d){a.bigPin.comments.push({posterName:b.userName,content:d,posterImg:b.userImg}),c({method:"post",url:"/api/gamepin/addComment",data:{pinId:a.bigPin.id,posterId:b.userEmail,posterName:b.userName,content:d}}).success(function(){$("textarea.view_respond_txtarea").val("")}).error(function(){})},a.follow=function(c){var d=b.follow(c);d.then(function(){$("#follow_user").attr("disabled","disabled")},function(){console.log("$rootScope follow failed"),a.bigFollowBtn=!1})},a.popMessage=function(){function d(){var c=!1,d=!1;for(var h in e.conversations)if(e.conversations[h]&&e.conversations[h].target===g){c=!0;break}for(var i in a.user.conversations)if(a.user.conversations[i]&&a.user.conversations[i].target===f){d=!0;break}if(console.log(c&&d),c&&d)for(var j in b.convoData)b.convoData[j].targetUser===g&&b.popConversation(b.convoData[j]);else $("#messageModal form")[0].reset(),$("#messageModal").modal()}var e,f=b.userEmail,g=a.user.email;c({method:"post",url:"/api/user/getProfile",data:{email:f}}).success(function(a){return a.error?b.popNotify("Error","Server Error"):(e=a.profileData,d(),void 0)}).error(function(){b.popNotify("Error","Server Error")})},a.sendMessage=function(c){var d=b.userEmail,e=a.user.email;b.message(c,d,e,function(a,c){a?b.popNotify(a):c&&b.popNotify(c)})},a.getGroupData=function(){a.displayMode.activity=!1,a.displayMode.group=!0,c({method:"post",url:"/api/user/getGroups",data:{userName:a.user.userName}}).success(function(b){a.groupList=[],a.groupData=b.groups;for(var c in b.groups)a.groupList.push(c);a.showPins=null}).error(function(a){console.log(a)})},a.sendMessage=function(c){var d=b.userEmail,e=a.user.email;b.message(c,d,e,function(a,c){a?b.popNotify(a):c&&b.popNotify(c)})},a.getGroupData=function(){a.showGroups=!0,c({method:"post",url:"/api/user/getGroups",data:{userName:a.user.userName}}).success(function(b){a.groupList=[],a.groupData=b.groups;for(var c in b.groups)a.groupList.push(c);a.showPins=null}).error(function(a){console.log(a)})},a.friend=function(){c({method:"post",url:"/api/user/friendRequest",data:{sourceId:b.userEmail,targetId:a.user.email}}).success(function(a){a.success?b.popNotify(a.success):a.error&&b.popNotify("Error",a.error)}).error(function(a){console.log(a)})},a.showGroup=function(b){a.showPins=a.groupData[b]},a.showLikes=function(){return a.showGroups=!1,c({method:"post",url:"/api/user/getLikedPins",data:{email:a.user.email,pinIds:a.user.likes}}).success(function(c){c.error?b.popNotify("Error",c.error):c.likedPins&&(a.showPins=c.likedPins)}),deferred.promise}}];UserController.resolve={resolveUser:["$q","$route","$rootScope","$location","$http","$routeParams","$window",function(a,b,c,d,e){var f=a.defer(),g=b.current.params.username;return g===c.userName&&d.path("/profile"),$("#gamePinModal").modal("hide"),c.checkLogin(function(a,b){a?f.reject():b?e({method:"post",url:"/api/user/getProfile",data:{userName:g}}).success(function(a){a.error&&f.reject(),f.resolve(a)}).error(function(a){f.reject(a)}):d.path("/")}),f.promise}]};