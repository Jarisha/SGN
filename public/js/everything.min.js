var app=angular.module("myApp",["myApp.services","myApp.directives","myApp.filters"]),first=!0;app.config(["$routeProvider","$locationProvider",function(a,b){console.log("app.config()"),a.when("/",{templateUrl:"/partials/front/front",controller:FrontController,resolve:FrontController.resolve}).when("/store",{templateUrl:"/partials/store",controller:StoreController,resolve:StoreController.resolve}).when("/profile",{templateUrl:"/partials/profile/profile",controller:ProfileController,resolve:ProfileController.resolve}).when("/about",{templateUrl:"/partials/about/about",controller:AboutController,resolve:AboutController.resolve}).when("/about/:area",{templateUrl:"/partials/about/about",controller:AboutController,resolve:AboutController.resolve}).when("/user/:username",{templateUrl:"/partials/user/user",controller:UserController,resolve:UserController.resolve}).when("/post/:postId",{templateUrl:"/partials/post/post",controller:TempController,resolve:TempController.resolve}).when("/notfound",{templateUrl:"/partials/not_found"}).otherwise({templateUrl:"/partials/not_found"}),b.html5Mode(!0).hashPrefix("!")}]),app.run(["$rootScope","$http","$templateCache","$location","$timeout","$q",function(a,b,c,d,e,f){function g(){a.badInput?($("#imageUrlModal form").resetForm(),$("#imageUrlModal .urlInput").val(""),$("#imageUrlModal .thumbnail").empty(),$("#fileUploadModal form").resetForm(),$("#fileUploadModal .thumbnail").empty(),$("#youtubeModal form").resetForm(),$("#youtubeModal .urlInput").val(""),$("#youtubeModal .fileupload").empty()):($("#imageUrlModal form").resetForm(),$("#imageUrlModal .urlInput").val(""),$("#imageUrlModal .thumbnail").empty(),$("#fileUploadModal form").resetForm(),$("#fileUploadModal .thumbnail").empty(),$("#youtubeModal form").resetForm(),$("#youtubeModal .urlInput").val(""),$("#youtubeModal .fileupload").empty()),$('#imageUrlForm input[type="submit"],                   #uploadForm input[type="submit"],                   #youtubeUrlForm input[type="submit"]').attr("disabled","disabled")}console.log("app.run()"),a.notificationsDummyData={followersData:[{sourceUser:"user7@u.u",action:"followRecieved",target:"dtonys@gmail.com",sourceData:{email:"user7@u.u",userName:"user7",profileImg:"http://d45c79c0838c7014df33-00861601181b32db2671b5497da6d8c8.r84.cf1.rackcdn.com/GJUhS9F1oZEJaGD26kwOSdtg"}},{sourceUser:"user7@u.u",action:"followRecieved",target:"dtonys@gmail.com",sourceData:{email:"user7@u.u",userName:"user7",profileImg:"http://d45c79c0838c7014df33-00861601181b32db2671b5497da6d8c8.r84.cf1.rackcdn.com/GJUhS9F1oZEJaGD26kwOSdtg"}},{sourceUser:"user7@u.u",action:"followRecieved",target:"dtonys@gmail.com",sourceData:{email:"user7@u.u",userName:"user7",profileImg:"http://d45c79c0838c7014df33-00861601181b32db2671b5497da6d8c8.r84.cf1.rackcdn.com/GJUhS9F1oZEJaGD26kwOSdtg"}},{sourceUser:"user7@u.u",action:"followRecieved",target:"dtonys@gmail.com",sourceData:{email:"user7@u.u",userName:"user7",profileImg:"http://d45c79c0838c7014df33-00861601181b32db2671b5497da6d8c8.r84.cf1.rackcdn.com/GJUhS9F1oZEJaGD26kwOSdtg"}},{sourceUser:"user7@u.u",action:"followRecieved",target:"dtonys@gmail.com",sourceData:{email:"user7@u.u",userName:"user7",profileImg:"http://d45c79c0838c7014df33-00861601181b32db2671b5497da6d8c8.r84.cf1.rackcdn.com/GJUhS9F1oZEJaGD26kwOSdtg"}}],tagsData:[{name:"Bertha",target:"pin",time:3},{name:"Joan",target:"comment",time:4}],messagesData:[{name:"Jill",time:5}]},a.badInput=!1,Modernizr.input.placeholder||(a.badInput=!0),a.newConvos=0,a.convoData=[],a.selectedConvo,a.messageList,a.$on("$routeChangeStart",function(){console.log("Route Change Started!"),$("body").css("cursor","wait")}),a.$on("$routeChangeSuccess",function(){$("body").css("cursor","default")}),a.$on("$routeChangeError",function(){}),a.$on("$viewContentLoaded",function(){}),a.log=function(a){console.log(a)},a.alert=function(a){alert(a)},a.loggedIn=null,a.userName=null,a.userEmail=null,a.userImg="/images/30x30.gif",a.userEvents=[],a.pinEvents=[],a.convoData=[],a.pendingRequests={},a.set={password:null,confirm:null,userName:null,gender:null},a.post={url:null,content:null,name:null,publisher:null,description:null,category:null},a.section="",a.rootPath="",b.get("/api/getPath").success(function(b){a.rootPath=b.path}).error(function(a,b){result.message="Error: "+b}),$(window).on("scroll",function(){$(this).scrollTop()>200?$("#scrollup").fadeIn():$("#scrollup").fadeOut()}),a.scrollup=function(){$("html, body").animate({scrollTop:0},600)},a.popModal=function(){$("#changeAvatar").modal()},a.masonry=function(){console.log("masonry"),$("body").imagesLoaded().always(function(){console.log("go!"),$("#content").masonry({itemSelector:".game_pin, .store_pin",isFitWidth:!0})})},a.Emasonry=function(a){console.log("Emasonry"),$("#content").imagesLoaded().always(function(){$.when($("#content").masonry({itemSelector:".game_pin, .store_pin",isFitWidth:!0})).done(function(){return a()})})},a.reload=function(a){console.log("appendMason"),$("#content").imagesLoaded().always(function(){$.when($("#content").masonry("reload")).done(function(){return a()})})},a.remason=function(){$("#content").masonry("reload")},a.destroyMason=function(){$("#content").masonry("destroy")},a.profileMasonry=function(){$("#profile_data_inner").imagesLoaded().always(function(){$("#profile_data_inner").masonry({itemSelector:".game_pin",isFitWidth:!0}),e(function(){$("#profile_data_inner").masonry("reload")},1e3)})},a.profileReload=function(){console.log("reload profile masonry"),$("#profile_data_inner").imagesLoaded().always(function(){$("#profile_data_inner").masonry("reload")})},a.destroyProfileMason=function(){$("#profile_data_inner").masonry("destroy")},a.postGamePin=function(){a.post.name=null,a.post.publisher=null,a.post.category=null,a.post.description=null,a.post.url=null,a.post.content=null,g(),$("#postModal").modal()},a.popGeneric=function(){$("#genericModal").modal()},a.popFeedback=function(){$("#feedbackModal form")[0].reset(),$("#feedbackModal").modal()},a.popConversation=function(c){b({method:"post",url:"/api/user/getMessages",data:{convoId:c.id}}).success(function(b){b.messages&&(a.messageList=b.messages,a.selectedConvo=c,$("#convo_sidebar").css("display","block"),$("#conversationModal").modal())}).error(function(){})},a.chooseConversation=function(c){console.log("chooseConversation"),b({method:"post",url:"/api/user/getMessages",data:{convoId:c.id}}).success(function(b){b.messages&&(a.messageList=b.messages,a.selectedConvo=c)}).error(function(){})},a.popImageUrl=function(){$("#postModal").modal("hide"),$("#imageUrlModal").modal()},a.popFileUpload=function(){$("#postModal").modal("hide"),$("#fileUploadModal").modal()},a.popYoutubeUrl=function(){$("#postModal").modal("hide"),$("#youtubeModal").modal()},a.popFollowerNotifications=function(){$("#followerNotificationsModal").modal()},a.popTagNotifications=function(){$("#tagNotificationsModal").modal()},a.popBadgeModal=function(){$("#badgeModal").modal()},a.closeModal=function(a){console.log("close gamePinModal"),$("#gamePinModal").modal("hide"),e(function(){d.path(a.link)},10)};var h=null;a.popNotify=function(a,b){$("#alertContainer").removeClass(),$("#notify_status").text(a),$("#notify_message").text(b),"Error"===a?$("#alertContainer").addClass("errorAlert"):$("#alertContainer").addClass("successAlert"),$("#alertContainer").show(),h=e(function(){$("#alertContainer").fadeOut(500,function(){$("#notify_message").text("")})},5e3)},a.hideNotify=function(){e.cancel(h),$("#alertContainer").fadeOut(250,function(){$("#notify_message").text("")})},a.checkLogin=function(c){var d={};b({method:"POST",url:"/api/checkLogin"}).success(function(b){if(b.loggedIn){for(a.loggedIn=!0,a.userName=b.userName,a.userEmail=b.userId,a.userImg=b.avatarImg||"/images/30x30.gif",a.userEvents=b.userEvents,a.pinEvents=b.pinEvents,a.convoData=b.convoData,a.pendingRequests=b.pendingRequests,i=0,len=a.convoData.length;len>i;i++)a.convoData[i].notify===b.userId&&(a.newConvos++,a.convoData[i].newFlag=!0);return c(null,!0)}return b.loggedIn?(d.status="AJAX error",next("AJAX error",!0),c("AJAX error",null)):(a.loggedIn=!1,a.userName=null,a.userEmail=null,a.userImg=null,c(null,!1))}).error(function(a,b){return d.message="Error: "+b,c(b,null)})},a.logoutSubmit=function(){var c={};b({method:"POST",url:"/api/logout"}).success(function(b){b.logout&&(a.loggedIn=!1,a.userName=null,window.location="/")}).error(function(a,b){c.message="Error: "+b})},a.follow=function(c){var d=f.defer();return b({method:"post",url:"/api/user/follow",data:{sourceId:a.userEmail,targetName:c}}).success(function(b){b.error?(console.log("error"),a.popNotify("Error","Follow "+targetName+" failed"),d.resolve(!1)):(console.log("success"),a.popNotify("Success","Now Following "+c),d.resolve(!0))}).error(function(a){console.log(a)}),d.promise},a.like=function(c){b({method:"post",url:"/api/gamepin/like",data:{pinId:c.id,email:a.userEmail}}).success(function(b){b.error?a.popNotify("Error",b.error):b.success&&(a.popNotify("Success",b.success),c.likedFlag=!c.likedFlag,c.likedBy.length++)}).error(function(){a.popNotify("Error","Server Error")})},a.unlike=function(c){b({method:"post",url:"/api/gamepin/unlike",data:{pinId:c.id,email:a.userEmail}}).success(function(b){b.error?a.popNotify("Error",b.error):b.success&&(a.popNotify("Success",b.success),c.likedFlag=!c.likedFlag,c.likedBy.length--)}).error(function(){a.popNotify("Error","Server Error")})},a.sendFeedback=function(c){b({method:"post",url:"/api/user/submitFeedback",data:{sourceUser:a.userEmail,content:c}}).success(function(a){a.success&&$("#feedbackModal").modal("hide"),a.error&&alert(a.error)}).error(function(a){a&&alert(a)})},a.message=function(a,c,d,e){b({method:"post",url:"/api/user/message",data:{sourceId:c,targetId:d,content:a}}).success(function(a){return a.success?e(null,JSON.stringify(a.success)):a.error?e(JSON.stringify(a.error),null):void 0}).error(function(a){a&&alert(a)})},a.respond=function(c){b({method:"post",url:"/api/user/message",data:{sourceId:a.userEmail,targetId:a.selectedConvo.showUser.email,content:c}}).success(function(b){b.success&&a.messageList.push({sourceData:{userName:a.userName,profileImg:a.userImg},content:c}),b.error&&alert(JSON.stringify(b.error))}).error(function(a){a&&alert(a)})},a.consume=function(a,c,e){return console.log("consume + proceed to targetLink"),"friendRequest"===a.action?(d.path(a.targetLink),void 0):(e.splice(c,1),b({method:"post",url:"/api/user/consumeEvent",data:{eventId:a.id}}).success(function(){d.path(a.targetLink)}).error(function(){console.log("error")}),void 0)},a.consumeMessage=function(c){a.newConvos<=0||(a.newConvos--,c.newFlag=!1,b({method:"post",url:"/api/user/consumeMessage",data:{convoId:c.id}}).success(function(a){a.success||a.error&&alert(a.error)}).error(function(a){alert(a)}))},a.ignoreFriendRequest=function(c,d){b({method:"post",url:"/api/user/ignoreFriendRequest",data:{eventId:c.id,sourceId:c.sourceUser,targetId:c.target}}).success(function(b){b.success&&(a.userEvents.splice(d,1),a.popNotify("Success",b.success))}).error(function(b){console.log(b),a.popNotify("Error","Server Error")})},a.acceptFriend=function(c,d,e){console.log("sourceId: "+c.sourceUser+" targetId: "+a.userEmail+" consumedId: "+c.id),b({method:"post",url:"/api/user/acceptFriend",data:{sourceId:c.sourceUser,targetId:c.target,consumedId:c.id}}).success(function(b){b.success&&(e.splice(d,1),a.popNotify("Success","Friend Accepted")),b.error&&a.popNotify("Error",b.error)}).error(function(b){console.log(b),a.popNotify("Error","Server Error")})},a.viewSettings=function(){a.set.password=null,a.set.confirm=null,b({method:"post",url:"/api/getSettings",data:{email:a.userEmail}}).success(function(b){b.error&&a.popNotify("Error",b.error),b.success&&(a.set.gender=b.gender,a.set.userName=b.userName,$("#settingsModal").modal())}).error(function(b){a.popNotify("Error",b)})},a.editSettings=function(){b({method:"POST",url:"/api/editSettings",data:{email:a.userEmail,settings:a.set}}).success(function(b){b.error&&(console.log(b.error),a.popNotify("Error",b.error)),b.success&&(b.userName&&(a.userName=b.userName),a.popNotify("Success",b.notify)),a.set.password=null,a.set.confirm=null})},a.setupPostContent=function(){function b(a,b){$.ajax({type:"post",url:"/api/util/validImg",data:"url="+a,success:function(a){a.valid?b(!0,a.contentType):b(!1,null)},error:function(){b(!1,null)}})}function c(a,b){$.ajax({type:"post",url:"/api/util/validVideo",data:"url="+h,success:function(a){a.valid?b(!0,a):b(!1,null)},error:function(){b(!1,null)}})}$("input, textarea").placeholder(),$(".btn-file input").click(function(){$("#uploadForm .fileSubmit").removeAttr("disabled")}),$("#uploadForm a[data-dismiss='fileupload']").click(function(){$("#uploadForm .fileSubmit").attr("disabled","disabled")}),$("#uploadForm").submit(function(){return $("#"+$(this)[0].id+' input[type="submit"]').attr("disabled","disabled"),$("#fileUploadModal *").css("cursor","wait"),$(this).ajaxSubmit({beforeSubmit:function(){percent=0,setTimeout(function(){},5e3)},uploadProgress:function(a,b,c,d){},success:function(b){$("#"+$(this)[0].id+' input[type="submit"]').removeAttr("disabled"),$("#fileUploadModal *").css("cursor","auto"),b.error||($("#fileUploadModal").modal("hide"),a.popNotify("Success","Post Image Success!"))},error:function(a,b,c,d){$("#"+$(this)[0].id+' input[type="submit"]').removeAttr("disabled"),$("#fileUploadModal *").css("cursor","auto"),d.css("cursor","auto")},dataType:"json"}),!1});var d,e,f=$(".get_image"),g=$("#imageUrlForm").find(".thumbnail");f.click(function(){d=f.next(".urlInput").val(),b(d,function(a,b){a&&(e=b,$("#imageUrlForm .fileSubmit").removeAttr("disabled"),g.empty(),g.append('<img src="'+d+'"/>'))})}),$("#imageUrlForm").submit(function(){return $("#"+$(this)[0].id+' input[type="submit"]').attr("disabled","disabled"),$("#imageUrlModal *").css("cursor","wait"),$.ajax({type:"post",url:"/api/gamepin/postImageUrl",data:$(this).serialize()+"&url="+d+"&type="+e,success:function(b){return $("#"+$(this)[0].id+' input[type="submit"]').removeAttr("disabled"),$("#imageUrlModal *").css("cursor","auto"),b.error?($("#imageUrlModal").modal("hide"),a.popNotify(b.error),void 0):($("#imageUrlModal").modal("hide"),a.popNotify("Post Image Success!"),void 0)},error:function(){$("#"+$(this)[0].id+' input[type="submit"]').removeAttr("disabled"),$("#imageUrlModal *").css("cursor","auto")}}),!1});var h,i,j,k=$(".get_video");k.click(function(){h=k.next(".urlInput").val(),c(h,function(a,b){a&&(i=b.url,j=b.embed,$("#youtubeModal .fileupload-new").append(b.embed),$("#youtubeModal .fileSubmit").removeAttr("disabled"))})}),$("#youtubeUrlForm").submit(function(){return $("#"+$(this)[0].id+' input[type="submit"]').attr("disabled","disabled"),$("#youtubeUrlForm *").css("cursor","wait"),$.ajax({type:"post",url:"/api/gamepin/postYoutubeUrl",data:$(this).serialize()+"&imgUrl="+i+"&embedHtml="+j,success:function(b){$("#"+$(this)[0].id+' input[type="submit"]').removeAttr("disabled"),$("#youtubeUrlForm *").css("cursor","auto"),b.error||($("#youtubeModal").modal("hide"),a.popNotify("Post Video Success!"))},error:function(){$("#"+$(this)[0].id+' input[type="submit"]').removeAttr("disabled"),$("#youtubeUrlForm *").css("cursor","auto")}}),!1}),$("#uploadAvatar").submit(function(){return $(this).ajaxSubmit({success:function(a){a.error||(window.location="/register")},error:function(){},dataType:"json"}),!1}),a.changeavatar=function(){$("#changeAvatar").modal(),$("#changeAvatarForm").submit(function(){return $("#changeAvatar :submit").attr("disabled","disabled"),$("#changeAvatar *").css("cursor","wait"),$(this).ajaxSubmit({dataType:"text",success:function(b){$("#changeAvatar :submit").removeAttr("disabled"),$("#changeAvatar *").css("cursor","auto"),window.location="/profile",b.error||($("#changeAvatar").modal("hide"),a.popNotify(b.success))},error:function(){$("#changeAvatar :submit").removeAttr("disabled"),$("#changeAvatar *").css("cursor","auto")}}),!1})}}}]),angular.module("myApp.directives",[]).directive("appVersion",["version",function(a){return function(b,c){c.text(a)}}]).directive("masonry",function(){return{restrict:"A",link:function(a){a.$last&&first&&console.log("last")}}}).directive("profileMasonry",function(){return{restrict:"A",link:function(a){a.$last&&(console.log("profile last"),a.profileMasonry())}}}).directive("stopEvent",function(){return{restrict:"A",link:function(a,b,c){b.bind(c.stopEvent,function(a){a.stopPropagation()})}}}).directive("scrollBottom",function(){return{link:function(a){if(a.$last){$("#respond_message").focus();var b=$(".convo_right")[0].scrollHeight;$(".convo_right").scrollTop(b)}}}}),angular.module("myApp.filters",[]).filter("interpolate",["version",function(a){return function(b){return String(b).replace(/\%VERSION\%/gm,a)}}]).filter("reverse",function(){return function(a){return a.slice().reverse()}}),angular.module("myApp.services",[]).value("version","0.1").service("printService",function(){this.printSomething=function(a){return a}}).factory("printFactory",function(){var a=0;return{printSomething:function(b){return a++,b}}}).factory("objFactory",function(){var a={param1:null,param2:null};return function(b,c){return a.param1=b,a.param2=c,a}}).factory("gamepinService",["$http","$rootScope",function(a,b){return{getPinList:function(c){a({method:"POST",url:b.rootPath+"/api/getPinList"}).success(function(a){a.objects?c(a):c("error")}).error(function(){})},getPinData:function(c,d){a({method:"POST",url:b.rootPath+"/api/gamepin/getPinData",data:{pinId:c}}).success(function(a){a.gamepin?d(a.gamepin):d("error")}).error(function(){})},categorySearch:function(c,d){a({method:"POST",url:b.rootPath+"/api/categorySearch",data:{category:c}}).success(function(a){a.objects?d(a):d("error")}).error(function(){})},textSearch:function(c,d){a({method:"POST",url:b.rootPath+"/api/textSearch",data:{text:c}}).success(function(a){a.objects?d(a):d("error")}).error(function(){})}}}]).service("loadContent",["$q","gamepinService",function(a,b){this.loadPins=function(){var c=a.defer();return b.getPinList(function(a){a.objects?c.resolve(a.objects):c.reject("Error")}),c.promise}}]);var AboutController=["$scope","$rootScope","$http","$location","resolveAbout","$routeParams",function(a,b,c,d,e,f){switch(b.css="about",b.title="about",a.modals=b.rootPath+"/partials/modals",a.subnav=null,a.nav=b.rootPath+"/partials/navbar",a.content=b.rootPath+"/partials/about/about_content",a.section=b.rootPath+"/partials/about/faq",a.setup=function(){aboutSetup(a)},a.viewFAQ=function(){$(".about_selected").removeClass("about_selected"),$(".faq_slice").addClass("about_selected"),a.section=b.rootPath+"/partials/about/faq"},a.viewToS=function(){$(".about_selected").removeClass("about_selected"),$(".tos_slice").addClass("about_selected"),a.section=b.rootPath+"/partials/about/tos"},a.viewPrivacy=function(){$(".about_selected").removeClass("about_selected"),$(".privacy_slice").addClass("about_selected"),a.section=b.rootPath+"/partials/about/privacy"},a.viewAcceptable=function(){$(".about_selected").removeClass("about_selected"),$(".view_slice").addClass("about_selected"),a.section=b.rootPath+"/partials/about/acceptable"},f.area){case"faq":$(".about_selected").removeClass("about_selected"),$(".faq_slice").addClass("about_selected"),a.section=b.rootPath+"/partials/about/faq",a.viewFAQ();break;case"tos":$(".about_selected").removeClass("about_selected"),$(".tos_slice").addClass("about_selected"),a.section=b.rootPath+"/partials/about/tos",a.viewToS();break;case"privacy":$(".about_selected").removeClass("about_selected"),$(".privacy_slice").addClass("about_selected"),a.section=b.rootPath+"/partials/about/privacy",a.viewPrivacy();break;case"acceptable":$(".about_selected").removeClass("about_selected"),$(".view_slice").addClass("about_selected"),a.section=b.rootPath+"/partials/about/acceptable",a.viewAcceptable()}a.ajaxLogout=function(){b.logout(function(b){b.message&&(a.status=b.message)})}}];AboutController.resolve={resolveAbout:["$q","$rootScope","$location",function(a,b,c){var d=a.defer();return $("#gamePinModal").modal("hide"),b.checkLogin(function(a,b){a?d.reject(a):b?d.resolve():c.path("/")}),d.promise}]};var FrontController=["$scope","$rootScope","$http","$location","$templateCache","$timeout","$routeParams","resolveFront","gamepinService","$window",function(a,b,c,d,e,f,g,h,j,k){function l(){var b=document.documentElement.scrollHeight-document.documentElement.clientHeight,c=k.pageYOffset;a.flag&&300>=b-c&&($("#load_spin").removeClass("hidden"),100>=b-c?$(".rackspace_logo").fadeIn():$(".rackspace_logo").fadeOut(),a.loadMore(),a.flag=!1),b-c>=400&&($(".rackspace_logo").fadeOut(),a.flag=!0)}function m(){n=0,o=10,p=0,console.log("loadFirst"),first=!0;var c=[];for(p=n+o;p>n&&a.gamePins[n];n++)a.gamePins[n].hidden=!0,c.push(a.gamePins[n]);a.showPins=a.showPins.concat(c),$("#load_spin").addClass("hidden"),b.Emasonry(function(){a.$apply(function(){for(i in c)c[i].hidden=!1;$("#load_spin").addClass("hidden")})})}a.showPins=[],a.gamePins=h,a.recommendedPins=[],b.css="front",a.modals=b.rootPath+"/partials/modals",a.subnav=b.rootPath+"/partials/front/front_subnav",a.nav=b.rootPath+"/partials/navbar",a.content=b.rootPath+"/partials/front_content",a.searchText="",a.appendHtml="",a.container=$("#content"),a.masonInit=!0,a.flag=!0,a.bigPin={},a.bigPin.followBtn=!0,a.first=!0;var n=0,o=10,p=0;a.fbModal=function(){$("#fbRegisterModal").modal()},a.changeState=function(){a.masonInit=!1},a.$on("$routeChangeStart",function(){$(window).off("scroll",l)}),$(window).on("scroll",l),a.loadMore=function(){console.log("loadMore"),first=!1;var c=[];for(p=n+o;p>n;n++)a.gamePins[n]&&(a.gamePins[n].hidden=!0,c.push(a.gamePins[n]));a.$apply(function(){a.showPins=a.showPins.concat(c)}),b.reload(function(){a.$apply(function(){for(i in c)c[i].hidden=!1;$("#load_spin").addClass("hidden")})})},a.setupContent=function(){$("#content").on("mouseenter",".game_pin",function(){$(this).find(".game_options").removeClass("hidden")}),$("#content").on("mouseleave",".game_pin",function(){$(this).find(".game_options").addClass("hidden")}),m()},a.getfront=function(){$("#load_spin").removeClass("hidden"),b.destroyMason(),a.showPins=[],j.getPinList(function(b){a.gamePins=b.objects,n=0,o=10,p=0,m()})},a.catSearch=function(c){function d(){e=a.gamePins,a.showPins=[],a.gamePins=e,m()}$("#load_spin").removeClass("hidden"),b.destroyMason();var e=[];j.categorySearch(c,function(b){a.gamePins=b.objects,d()})},a.textsearch=function(c){function d(){e=a.gamePins,n=0,o=10,p=0,a.showPins=[],a.gamePins=e,m()}$("#load_spin").removeClass("hidden"),b.destroyMason();var e=[];j.textSearch(c,function(b){a.gamePins=b.objects,d()})},a.getFollowing=function(){function d(){var c=a.gamePins.slice();for(i=0;i<c.length;i++)f[c[i].poster]||(c.splice(i,1),i--);a.gamePins=c,n=0,o=10,p=0,m(),b.masonry()}var e,f={};a.showPins=[],b.destroyMason(),c({method:"post",url:"/api/user/getProfile",data:{email:b.userEmail}}).success(function(a){for(e=a.profileData.following,i=0,len=e.length;len>i;i++)f[e[i].userName]=!0;d()}).error(function(a){alert(a)})},a.getPopular=function(){function c(a,b){return a.comments.length+a.likedBy.length<b.comments.length+b.likedBy.length?1:-1}a.showPins=[],b.destroyMason();var d=a.gamePins.slice();d.sort(c),a.gamePins=d,n=0,o=10,p=0,m(),b.masonry()},b.popRecommended=function(b){$("#gamePinModal").modal("hide"),a.viewBigPin(b)},a.viewBigPin=function(d){console.log(a.showPins[d].poster),$(".view_vid").empty(),j.getPinData(a.showPins[d].id,function(e){if(a.bigPin.index=d,a.bigPin=a.showPins[d],a.bigPin.posterImg=a.bigPin.posterImg||b.rootPath+"/images/30x30.gif",a.bigPin.gameName=e.gameName,a.bigPin.publisher=e.publisher,a.bigPin.datePosted=e.datePosted,a.bigPin.videoEmbed=e.videoEmbed,a.bigPin.likedBy=e.likedBy,console.log(e.likedBy),a.bigPin.comments=e.comments,console.log(a.bigPin.posterName+" === "+b.userName),a.bigPin.videoEmbed){var f=$.parseHTML(a.bigPin.videoEmbed);f[0].width="560",f[0].height="341",$(".view_vid").append(f)}for(a.recommendedPins=[],i=0,len=a.showPins.length;len>i;i++)a.showPins[i].category===a.bigPin.category&&a.showPins[i].id!==a.bigPin.id&&a.recommendedPins.push({index:i,image:a.showPins[i].imageUrl||a.showPins[i].sourceUrl,link:"/post/"+a.showPins[i].id});$("#recommend_sidebar").css("display","block"),$("#gamePinModal").modal({dynamic:!0}),c({method:"post",url:"/api/getFollowers",data:{email:b.userEmail}}).success(function(c){if(c.error)b.popNotify("Error",c.error);else if(c.success){var e=c.following;$("#gamePinModal .follow"),a.bigFollowBtn=a.showPins[d].poster===b.userName||-1!==e.indexOf(a.bigPin.posterId)?!1:!0}}).error(function(){})})},a.follow=function(c){var d=b.follow(c);d.then(function(){a.bigPin.followBtn=!1},function(){console.log("$rootScope follow failed"),a.bigPin.followBtn=!1})},a.setupModals=function(){b.setupPostContent(),c({method:"POST",url:"/api/facebookRegister"}).success(function(a){a.fb&&(b.register.email=a.fbEmail,b.register.name=a.fbName,b.register.fbConnect=!0,$("#fbRegisterModal").modal())}).error(function(b,c){a.message="Server Error: "+c}),sessionStorage.registerAlert&&(b.popNotify(sessionStorage.registerAlert),sessionStorage.removeItem("registerAlert"))},a.addBigComment=function(d){a.bigPin.comments.push({posterName:b.userName,content:d,posterImg:b.userImg}),c({method:"post",url:"/api/gamepin/addComment",data:{pinId:a.bigPin.id,posterId:b.userEmail,posterName:b.userName,content:d}}).success(function(){$("textarea.view_respond_txtarea").val(""),b.remason()}).error(function(){})},a.addComment=function(d,e){b.rootSettings,a.showPins[e].comments.push({posterName:b.userName,content:d,posterImg:b.userImg}),c({method:"post",url:"/api/gamepin/addComment",data:{pinId:a.showPins[e].id,posterId:b.userEmail,posterName:b.userName,content:d}}).success(function(c){c.error,a.text=null,b.remason()}).error(function(){})},a.loadOne=function(){a.showPins.push({id:"Z",description:"Z",poster:"Z",category:"Z"}),a.showPins.push({id:"Z",description:"Z",poster:"Z",category:"Z"}),a.showPins.push({id:"Z",description:"Z",poster:"Z",category:"Z"}),a.showPins.push({id:"Z",description:"Z",poster:"Z",category:"Z"}),a.showPins.push({id:"Z",description:"Z",poster:"Z",category:"Z"}),a.showPins.push({id:"Z",description:"Z",poster:"Z",category:"Z"}),f(function(){a.flag=!0},100)},a.affix=function(){$("#subnav").affix({offset:42})}}];FrontController.resolve={resolveFront:["$q","$rootScope","gamepinService",function(a,b,c){var d=a.defer();return $("#gamePinModal").modal("hide"),b.checkLogin(function(a){a&&d.reject(a),c.getPinList(function(a){a.objects?d.resolve(a.objects):d.reject("Error")})}),d.promise}]};var StoreController=["$scope","$rootScope","$http","$location","$templateCache","resolveStore",function(a,b){b.css="store",b.title="front",a.subnav=b.rootPath+"/partials/store_subnav",a.nav=b.rootPath+"/partials/navbar",a.content=b.rootPath+"/partials/store_content",a.register={name:null,password:null,confirm:null},a.login={name:null,password:null},a.masonInit=!0,a.bigPin={},a.changeState=function(){a.masonInit=!1},a.dummyData=[{name:"Minecraft",price:"Free",publisher:"Mojang",image:"https://minecraft.net/images/mobile/desktop_thumb1.png",screenshot:"https://minecraft.net/images/mobile/desktop_screen4.png",video:"http://youtu.be/FaMTedT6P0I",description:"We're extremely happy to finally roll out Minecraft – Pocket Edition on most devices running Android or iOS in the Solar System. Now no matter where you are there's always time to place blocks and build whatever your heart can imagine.",category:"Strategy",playStoreUrl:"https://play.google.com/store/apps/details?id=com.mojang.minecraftpe",platform:"Android"},{name:"Great Big War Game",price:"$4.99",image:"https://lh5.ggpht.com/jqfH4JorIDE0QrKr8w9TBDS6H6nAI1A7LpWLFQGwlY1I8fqAy33tBT1c6kVqa_HEDw=w124",category:"Strategy",playStoreUrl:"https://play.google.com/store/apps/details?id=com.rubicon.dev.gbwg",platform:"Android"},{name:"Angry Birds Space Premium",price:"N/A",image:"https://lh3.ggpht.com/aQaIEGrmba1ENSEgUtArdm3yhJUug7BRWlu_WaspoJusZyHv1rjlWtYqe_qRjE_Kmh1E=w124",category:"Puzzle",playStoreUrl:"https://play.google.com/store/apps/details?id=com.rovio.angrybirdsspace.premium",platform:"Android"},{name:"Cut the Rope",price:"$0.99",image:"http://localhost/images/game_images/store_img5.png",category:"Puzzle",playStoreUrl:"https://play.google.com/store/apps/details?id=com.zeptolab.ctr.paid",platform:"Android"},{name:"Move the Box Pro",price:"$0.99",image:"https://lh3.ggpht.com/hhurG5c5QP9dn6AN80mPdkxrK_0BwsRrNaEnXSANenpoFH0nKXkDJLTLIvAG_5vgdA=w124",category:"Puzzle",playStoreUrl:"https://play.google.com/store/apps/details?id=ua.co.cts.movethebox",platform:"Android"},{name:"Bomba",price:"$0.99",image:"https://lh3.ggpht.com/dKcPug5YXNwEULvix5WMPGjvEEbAFINvbm8Xbko0NRk4S9bdeTGGBxXWKcyUiIiJ9-Y=w124",category:"Puzzle",playStoreUrl:"https://play.google.com/store/apps/details?id=com.GamesLab.Bomba",platform:"Android"},{name:"SpellTower",price:"$1.99",image:"http://a1.mzstatic.com/us/r1000/092/Purple/v4/49/52/7d/49527d33-52c8-1b0e-7d19-6667853cc697/mza_5638865484617812239.175x175-75.jpg",category:"Puzzle",appStoreUrl:"https://itunes.apple.com/us/app/spelltower/id476500832?mt=8",platform:"iPhone"}],a.viewStorePin=function(b){a.bigPin=a.dummyData[b],$("#storePinModal").modal({dynamic:!0})},a.setup=function(){b.masonry()}}];StoreController.resolve={resolveStore:["$q","$rootScope","$location",function(a,b,c){var d=a.defer();return $("#gamePinModal").modal("hide"),b.checkLogin(function(a,b){a?d.reject(a):b?d.resolve():c.path("/")}),d.promise}]};var ProfileController=["$scope","$rootScope","$http","$location","$timeout","resolveProfile","gamepinService",function(a,b,c,d,e,f,g){console.log("ProfileController"),b.css="profile",b.title="profile",a.R_Data=f,a.timeline=f.timeline,a.profile=f.profileData,a.profile.bio=a.profile.bio||null,a.dummyData={badges:[{url:"http://localhost/images/misc_images/badge1.png"},{url:"http://localhost/images/misc_images/badge1.png"},{url:"http://localhost/images/misc_images/badge1.png"},{url:"http://localhost/images/misc_images/badge1.png"},{url:"http://localhost/images/misc_images/badge1.png"},{url:"http://localhost/images/misc_images/badge1.png"},{url:"http://localhost/images/misc_images/badge1.png"},{url:"http://localhost/images/misc_images/badge1.png"},{url:"http://localhost/images/misc_images/badge1.png"},{url:"http://localhost/images/misc_images/badge1.png"}],followers:[{url:"http://localhost/images/30x30.gif"},{url:"http://localhost/images/30x30.gif"}],following:[{url:"http://localhost/images/30x30.gif"},{url:"http://localhost/images/30x30.gif"}]},a.showPins=null,a.groupList=[],a.groupData={},a.modals=b.rootPath+"/partials/modals",a.subnav=null,a.nav=b.rootPath+"/partials/navbar",a.content=b.rootPath+"/partials/profile_content",a.masonInit=!0,a.FOLLOW=1,a.FRIEND=2,a.GROUPS=1,a.LIKES=3,a.people_tab=a.FOLLOW,a.timeline_tab="showAll",a.content_tab=0,a.group_tab=null,a.bigPin={},a.bigFollowBtn=!1,a.changeImage=!1,a.changeState=function(){a.masonInit=!1};for(var h in a.timeline){var i=a.timeline[h];if("commentPosted"===i.action)switch(i.message="Comment posted to "+i.target,i.target){case"Action & Adventure":i.sourceImg="/images/caticon-action22x22.png";break;case"Arcade":i.sourceImg="/images/caticon-arcade22x22.png";break;case"Board & Card":i.sourceImg="/images/caticon-card22x22.png";break;case"Casino & Gambling":i.sourceImg="/images/caticon-casino22x22.png";break;case"Educational":i.sourceImg="/images/caticon-educational22x22.png";break;case"Family & Kids":i.sourceImg="/images/caticon-family22x22.png";break;case"Music & Rhythm":i.sourceImg="/images/caticon-music22x22.png";break;case"Puzzle":i.sourceImg="/images/caticon-puzzle22x22.png";break;case"Racing":i.sourceImg="/images/caticon-racing22x22.png";break;case"Role Playing":i.sourceImg="/images/caticon-rpg22x22.png";break;case"Simulation":i.sourceImg="/images/caticon-simulation22x22.png";break;case"Sports":i.sourceImg="/images/caticon-sports22x22.png";
break;case"Strategy":i.sourceImg="/images/caticon-strategy22x22.png";break;case"Trivia & Word":i.sourceImg="/images/caticon-arcade22x22.png";break;default:alert("event image: default case")}else if("gamepinPosted"===i.action)switch(i.message="Posted to "+i.target,i.target){case"Action & Adventure":i.sourceImg="/images/caticon-action22x22.png";break;case"Arcade":i.sourceImg="/images/caticon-arcade22x22.png";break;case"Board & Card":i.sourceImg="/images/caticon-card22x22.png";break;case"Casino & Gambling":i.sourceImg="/images/caticon-casino22x22.png";break;case"Educational":i.sourceImg="/images/caticon-educational22x22.png";break;case"Family & Kids":i.sourceImg="/images/caticon-family22x22.png";break;case"Music & Rhythm":i.sourceImg="/images/caticon-music22x22.png";break;case"Puzzle":i.sourceImg="/images/caticon-puzzle22x22.png";break;case"Racing":i.sourceImg="/images/caticon-racing22x22.png";break;case"Role Playing":i.sourceImg="/images/caticon-rpg22x22.png";break;case"Simulation":i.sourceImg="/images/caticon-simulation22x22.png";break;case"Sports":i.sourceImg="/images/caticon-sports22x22.png";break;case"Strategy":i.sourceImg="/images/caticon-strategy22x22.png";break;case"Trivia & Word":i.sourceImg="/images/caticon-arcade22x22.png";break;default:alert("event image: default case")}else"followSent"===i.action?(i.message="Following "+i.targetData.userName,i.sourceImg=i.targetData.profileImg||"/images/30x30.gif"):"friendAccepted"===i.action&&(i.targetData.userName!==a.profile.userName?(i.message="Friended "+i.targetData.userName,i.sourceImg=i.targetData.profileImg||"/images/30x30.gif",i.targetLink="/user/"+i.targetData.userName):(i.message="Friended "+i.sourceData.userName,i.sourceImg=i.sourceData.profileImg||"/images/30x30.gif",i.targetLink="/user/"+i.sourceData.userName))}a.setup=function(){$(window).scroll(function(){$(this).scrollTop()>200?$("#scrollup").fadeIn():$("#scrollup").fadeOut()}),$(".change_avatar"),a.scrollup=function(){$("html, body").animate({scrollTop:0},600)}},a.ajaxLogout=function(){b.logout(function(b){b.message&&(a.status=b.message)})},a.viewBigPin=function(d){$(".view_vid").empty(),g.getPinData(d.id,function(e){if(a.bigPin=d,a.bigPin.gameName=e.gameName,a.bigPin.publisher=e.publisher,a.bigPin.datePosted=e.datePosted,a.bigPin.videoEmbed=e.videoEmbed,a.bigPin.comments=e.comments,a.bigPin.profileImg=e.profileImg||b.rootPath+"/images/30x30.gif",a.bigPin.videoEmbed){var f=$.parseHTML(a.bigPin.videoEmbed);f[0].width="560",f[0].height="341",$(".view_vid").append(f)}$("#gamePinModal").modal({dynamic:!0}),c({method:"post",url:"/api/getFollowers",data:{email:b.userEmail}}).success(function(c){if(c.error)b.popNotify("Error",c.error);else if(c.success){var d=c.following;$("#gamePinModal .follow"),a.bigFollowBtn=-1!==d.indexOf(a.bigPin.posterId)?!1:!0}}).error(function(a){console.log(a)})})},a.addBigComment=function(d){a.bigPin.comments.push({posterName:b.userName,content:d,posterImg:b.userImg}),c({method:"post",url:"/api/gamepin/addComment",data:{pinId:a.bigPin.id,posterId:b.userEmail,posterName:b.userName,content:d}}).success(function(){$("textarea.view_respond_txtarea").val("")}).error(function(){})},a.getGroupData=function(){a.content_tab=a.GROUPS,c({method:"post",url:"/api/user/getGroups",data:{userName:a.profile.userName}}).success(function(b){a.groupList=[],a.groupData=b.groups;for(var c in b.groups)a.groupList.push(c);a.showPins=null})},a.showGroup=function(b){a.group_tab=b,a.showPins=a.groupData[b]},a.showLikes=function(){a.content_tab=a.LIKES,a.group_tab=null,c({method:"post",url:"/api/user/getLikedPins",data:{email:a.profile.email,pinIds:a.profile.likes}}).success(function(c){c.error?b.popNotify("Error",c.error):c.likedPins&&(a.showPins=c.likedPins)}).error(function(a){console.log(a)})}}];ProfileController.resolve={resolveProfile:["$q","$rootScope","$location","$http","$timeout",function(a,b,c,d){var e=a.defer();return b.checkLogin(function(a,f){a?e.reject(a):f?d({method:"post",url:"/api/user/getProfile",data:{userName:b.userName}}).success(function(a){a.error&&e.reject(),e.resolve(a)}).error(function(a){e.reject(a)}):c.path("/")}),e.promise}]};var TempController=["$scope","$rootScope","$http","$location","$routeParams","$route","gamepinService","resolveTemp",function(a,b,c,d,e,f,g){var h=f.current.params.postId;console.log(b.loggedIn),console.log("TempController"),console.log("id: "+h),b.css="post",b.title="post",a.pagePin={},g.getPinData(h,function(b){a.pagePin=b,console.log(b)})}];TempController.resolve={resolveTemp:["$q","$rootScope","$location",function(a){var b=a.defer();return $("#gamePinModal").modal("hide"),b.resolve(),b.promise}]};var UserController=["$scope","$rootScope","$http","$location","$routeParams","resolveUser","gamepinService",function(a,b,c,d,e,f,g){console.log("UserController"),b.css="profile",b.title="user",a.timeline=f.timeline,a.user=f.profileData,a.user.bio=a.user.bio||null,a.showPins=null,a.groupList=[],a.groupData={},a.bigPin={},a.bigPin.followBtn=!1,a.isFollowing=!1,a.isFriend=!1,a.pendingFriend=!1,a.FOLLOW=1,a.FRIEND=2,a.GROUPS=1,a.LIKES=3,a.content_tab="none",a.people_tab=a.FOLLOW,a.timeline_tab="showAll",a.group_tab=null,a.modals=b.rootPath+"/partials/modals";for(var h in a.timeline){var i=a.timeline[h];if("commentPosted"===i.action)switch(i.message="Comment posted to "+i.target,i.target){case"Action & Adventure":i.sourceImg="/images/caticon-action22x22.png";break;case"Arcade":i.sourceImg="/images/caticon-arcade22x22.png";break;case"Board & Card":i.sourceImg="/images/caticon-card22x22.png";break;case"Casino & Gambling":i.sourceImg="/images/caticon-casino22x22.png";break;case"Educational":i.sourceImg="/images/caticon-educational22x22.png";break;case"Family & Kids":i.sourceImg="/images/caticon-family22x22.png";break;case"Music & Rhythm":i.sourceImg="/images/caticon-music22x22.png";break;case"Puzzle":i.sourceImg="/images/caticon-puzzle22x22.png";break;case"Racing":i.sourceImg="/images/caticon-racing22x22.png";break;case"Role Playing":i.sourceImg="/images/caticon-rpg22x22.png";break;case"Simulation":i.sourceImg="/images/caticon-simulation22x22.png";break;case"Sports":i.sourceImg="/images/caticon-sports22x22.png";break;case"Strategy":i.sourceImg="/images/caticon-strategy22x22.png";break;case"Trivia & Word":i.sourceImg="/images/caticon-arcade22x22.png";break;default:alert("event image: default case")}else if("gamepinPosted"===i.action)switch(i.message="Posted to "+i.target,i.target){case"Action & Adventure":i.sourceImg="/images/caticon-action22x22.png";break;case"Arcade":i.sourceImg="/images/caticon-arcade22x22.png";break;case"Board & Card":i.sourceImg="/images/caticon-card22x22.png";break;case"Casino & Gambling":i.sourceImg="/images/caticon-casino22x22.png";break;case"Educational":i.sourceImg="/images/caticon-educational22x22.png";break;case"Family & Kids":i.sourceImg="/images/caticon-family22x22.png";break;case"Music & Rhythm":i.sourceImg="/images/caticon-music22x22.png";break;case"Puzzle":i.sourceImg="/images/caticon-puzzle22x22.png";break;case"Racing":i.sourceImg="/images/caticon-racing22x22.png";break;case"Role Playing":i.sourceImg="/images/caticon-rpg22x22.png";break;case"Simulation":i.sourceImg="/images/caticon-simulation22x22.png";break;case"Sports":i.sourceImg="/images/caticon-sports22x22.png";break;case"Strategy":i.sourceImg="/images/caticon-strategy22x22.png";break;case"Trivia & Word":i.sourceImg="/images/caticon-arcade22x22.png";break;default:alert("event image: default case")}else"followSent"===i.action?(i.message="Following "+i.targetData.userName,i.sourceImg=i.targetData.profileImg||"/images/30x30.gif"):"friendAccepted"===i.action&&(i.targetData.userName!==a.user.userName?(i.message="Friended "+i.targetData.userName,i.sourceImg=i.targetData.profileImg||"/images/30x30.gif",i.targetLink="/user/"+i.targetData.userName):(i.message="Friended "+i.sourceData.userName,i.sourceImg=i.sourceData.profileImg||"/images/30x30.gif",i.targetLink="/user/"+i.sourceData.userName))}for(var j=0,k=a.user.followers.length;k>j;j++)if(a.user.followers[j].userName===b.userName){a.isFollowing=!0;break}b.pendingRequests[a.user.email]&&(a.pendingFriend=!0);for(var j=0,k=a.user.friends.length;k>j;j++)if(a.user.friends[j].userName===b.userName){a.isFriend=!0;break}a.masonInit=!0,a.changeState=function(){a.masonInit=!1},a.setup=function(){$(window).scroll(function(){$(this).scrollTop()>200?$("#scrollup").fadeIn():$("#scrollup").fadeOut()}),$(".change_avatar"),a.scrollup=function(){$("html, body").animate({scrollTop:0},600)}},a.viewBigPin=function(d){g.getPinData(d.id,function(e){if(a.bigPin=d,a.bigPin.gameName=e.gameName,a.bigPin.publisher=e.publisher,a.bigPin.datePosted=e.datePosted,a.bigPin.videoEmbed=e.videoEmbed,a.bigPin.comments=e.comments,a.bigPin.profileImg=e.profileImg||b.rootPath+"/images/30x30.gif",a.bigPin.videoEmbed){var f=$.parseHTML(a.bigPin.videoEmbed);f[0].width="560",f[0].height="341",$(".view_vid").append(f)}$("#gamePinModal").modal({dynamic:!0}),c({method:"post",url:"/api/getFollowers",data:{email:b.userEmail}}).success(function(c){if(c.error)b.popNotify("Error",c.error);else if(c.success){var d=c.following;a.bigPin.followBtn=-1!==d.indexOf(a.bigPin.posterId)?!1:!0}}).error(function(a){console.log(a)})})},a.addBigComment=function(d){a.bigPin.comments.push({posterName:b.userName,content:d,posterImg:b.userImg}),c({method:"post",url:"/api/gamepin/addComment",data:{pinId:a.bigPin.id,posterId:b.userEmail,posterName:b.userName,content:d}}).success(function(){$("textarea.view_respond_txtarea").val("")}).error(function(){})},a.follow=function(c){var d=b.follow(c);d.then(function(){$("#follow_user").attr("disabled","disabled")},function(){console.log("$rootScope follow failed"),a.bigFollowBtn=!1})},a.popMessage=function(){function d(){var c=!1,d=!1;for(var h in e.conversations)if(e.conversations[h]&&e.conversations[h].target===g){c=!0;break}for(var i in a.user.conversations)if(a.user.conversations[i]&&a.user.conversations[i].target===f){d=!0;break}if(console.log(c&&d),c&&d)for(var j in b.convoData)b.convoData[j].targetUser===g&&b.popConversation(b.convoData[j]);else $("#messageModal form")[0].reset(),$("#messageModal").modal()}var e,f=b.userEmail,g=a.user.email;c({method:"post",url:"/api/user/getProfile",data:{email:f}}).success(function(a){return a.error?b.popNotify("Error","Server Error"):(e=a.profileData,d(),void 0)}).error(function(){b.popNotify("Error","Server Error")})},a.sendMessage=function(c){var d=b.userEmail,e=a.user.email;b.message(c,d,e,function(a,c){a?b.popNotify(a):c&&b.popNotify(c)})},a.getGroupData=function(){a.content_tab=a.GROUPS,c({method:"post",url:"/api/user/getGroups",data:{userName:a.user.userName}}).success(function(b){a.groupList=[],a.groupData=b.groups;for(var c in b.groups)a.groupList.push(c);a.showPins=null}).error(function(a){console.log(a)})},a.friend=function(){c({method:"post",url:"/api/user/friendRequest",data:{sourceId:b.userEmail,targetId:a.user.email}}).success(function(c){c.success?(b.popNotify(c.success),a.pendingFriend=!0):c.error&&b.popNotify("Error",c.error)}).error(function(a){console.log(a)})},a.showGroup=function(b){a.group_tab=b,a.showPins=a.groupData[b]},a.showLikes=function(){return a.content_tab=a.LIKES,a.group_tab=null,c({method:"post",url:"/api/user/getLikedPins",data:{email:a.user.email,pinIds:a.user.likes}}).success(function(c){c.error?b.popNotify("Error",c.error):c.likedPins&&(a.showPins=c.likedPins)}),deferred.promise}}];UserController.resolve={resolveUser:["$q","$route","$rootScope","$location","$http","$routeParams","$window",function(a,b,c,d,e){var f=a.defer(),g=b.current.params.username;return g===c.userName&&d.path("/profile"),$("#gamePinModal").modal("hide"),c.checkLogin(function(a,b){a?f.reject():b?e({method:"post",url:"/api/user/getProfile",data:{userName:g}}).success(function(a){a.error&&f.reject(),f.resolve(a)}).error(function(a){f.reject(a)}):d.path("/")}),f.promise}]};