db = require('./lib').getClient();

flight = {
  status: 'scheduled'
}

db.save('flights', 'KLM-5034', flight, { returnbody: true, dw: 'quorum', method: 'POST' }, function() {
  db.save('airlines', 'KLM', {country: 'NL'}, {links: [{bucket: 'flights', key: 'KLM-5034'}]}, function() {
    db.get('airlines', 'KLM', function(err, data, meta) {
      db.walk('airlines', 'KLM', [["_", "flights"]], function(err, data, meta) {
      })
    })
    db.mapreduce
      .add('airlines')
      .link({ bucket: 'flights', keep: true })
      .map('Riak.mapValuesJson')
      .reduce(['Riak.filterNotFound', function(value, count) { return value }])
      .run(function(err, flights) {
        console.log(flights)
    })
  })
})
